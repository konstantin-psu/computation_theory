\documentclass{article}

\usepackage{fancyhdr}
\usepackage{wrapfig}
\usepackage{extramarks}
\usepackage{multicol}
\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{amsfonts}
\usepackage{tikz}
\usepackage{forest,adjustbox}
\usepackage[plain]{algorithm}
\usepackage{algpseudocode}
\usepackage{enumerate}
\usepackage[shortlabels]{enumitem}                                          
                    \setlist[enumerate, 1]{1\textsuperscript{o}}



\usepackage{listings}
\usepackage{xcolor}
%\lstset { %
%    language=C++,
%    backgroundcolor=\color{black!5}, % set backgroundcolor
%    basicstyle=\footnotesize,% basic font setting
%}

%\usetikzlibrary{automata,positioning}
\usetikzlibrary{positioning,shapes,shadows,arrows,automata}

%
% Basic Document Settings
%

\topmargin=-0.45in
\evensidemargin=0in
\oddsidemargin=0in
\textwidth=6.5in
\textheight=9.0in
\headsep=0.25in

\linespread{1.1}

\pagestyle{fancy}
\lhead{\hmwkClass}
\chead{ (\hmwkClassInstructor\ \hmwkClassTime) }
\rhead{\shortName \hspace{0.4cm} \hmwkTitle}
\lfoot{\lastxmark}
\cfoot{\thepage}

\renewcommand\headrulewidth{0.4pt}
\renewcommand\footrulewidth{0.4pt}

\newcommand\curl[1]{\{#1\}}

\setlength\parindent{0pt}

%
% Create Problem Sections
%

\newcommand{\enterProblemHeader}[1]{
    \nobreak\extramarks{}{Problem \arabic{#1} continued on next page\ldots}\nobreak{}
    \nobreak\extramarks{Problem \arabic{#1} (continued)}{Problem \arabic{#1} continued on next page\ldots}\nobreak{}
}

\newcommand{\exitProblemHeader}[1]{
    \nobreak\extramarks{Problem \arabic{#1} (continued)}{Problem \arabic{#1} continued on next page\ldots}\nobreak{}
    \stepcounter{#1}
    \nobreak\extramarks{Problem \arabic{#1}}{}\nobreak{}
}

\setcounter{secnumdepth}{0}
\newcounter{partCounter}
\newcounter{homeworkProblemCounter}
\setcounter{homeworkProblemCounter}{1}
\nobreak\extramarks{Problem \arabic{homeworkProblemCounter}}{}\nobreak{}

%
% Homework Problem Environment
%
% This environment takes an optional argument. When given, it will adjust the
% problem counter. This is useful for when the problems given for your
% assignment aren't sequential. See the last 3 problems of this template for an
% example.
%
\newenvironment{homeworkProblem}[1][-1]{
    \ifnum#1>0
        \setcounter{homeworkProblemCounter}{#1}
    \fi
    \section{Problem \arabic{homeworkProblemCounter}}
    \setcounter{partCounter}{1}
    \enterProblemHeader{homeworkProblemCounter}
}{
    \exitProblemHeader{homeworkProblemCounter}
}

%
% Homework Details
%   - Title
%   - Due date
%   - Class
%   - Section/Time
%   - Instructor
%   - Author
%

\newcommand{\hmwkTitle}{Homework\ \#2}
\newcommand{\hmwkDueDate}{February 1 2016}
\newcommand{\hmwkClass}{CS581 Theory of Computation}
\newcommand{\hmwkClassTime}{Winter 2016}
\newcommand{\hmwkClassInstructor}{Harry H. Porter}
\newcommand{\hmwkAuthorName}{Konstantin Macarenco}
\newcommand{\shortName}{Konstantin M.}

%
% Title Page
%

\title{
    \vspace{2in}
    \textmd{\textbf{\hmwkClass:\ \hmwkTitle}}\\
    \normalsize\vspace{0.1in}\small{Due\ on\ \hmwkDueDate\ at 2:00pm}\\
    \vspace{0.1in}\large{\textit{\hmwkClassInstructor\ \hmwkClassTime}}
    \vspace{3in}
}

\author{\textbf{\hmwkAuthorName}}
\date{}

\renewcommand{\part}[1]{\textbf{\large Part \Alph{partCounter}}\stepcounter{partCounter}\\}
\newcommand{\answ}[1]{\hspace{1cm}\textbf{Answ:} #1}
\newcommand{\problem}[1]{\large{\textbf{Problem #1} \\}}

%
% Various Helper Commands
%

% Useful for algorithms
\newcommand{\alg}[1]{\textsc{\bfseries \footnotesize #1}}

% For derivatives
\newcommand{\deriv}[1]{\frac{\mathrm{d}}{\mathrm{d}x} (#1)}

% For partial derivatives
\newcommand{\pderiv}[2]{\frac{\partial}{\partial #1} (#2)}

% Integral dx
\newcommand{\dx}{\mathrm{d}x}

% Alias for the Solution section header
\newcommand{\solution}{\textbf{\large Solution}}

% Probability commands: Expectation, Variance, Covariance, Bias
\newcommand{\E}{\mathrm{E}}
\newcommand{\Var}{\mathrm{Var}}
\newcommand{\Cov}{\mathrm{Cov}}
\newcommand{\Bias}{\mathrm{Bias}}

\begin{document}

\maketitle

\pagebreak

\problem{2.6}
Give context-free grammars generating the following languages. \\  \\
\problem{2.6 b}
The complement of the language $\{a^n b^n | n \geq 0\}$ \\ \\

\begin{table}[h!]
\centering
\begin{tabular}{l}
$S \rightarrow a S b\: | \:b Y \:|\: Y a $\\
$Y \rightarrow b Y \:| \:a Y \:| \:\epsilon$
\end{tabular}
\end{table}

\problem{2.6 d}
$\{x_1 \# x_2 \# \cdots \# x_k |  k \geq 1, \text{ each }x_i \in \{a,b\}^*,\text{ and for some } i \text{ and } j, x_i 
= {x_j}^R\}$

\begin{table}[h!]
\centering
\begin{tabular}{l}
$S \rightarrow A B C $\\
$A \rightarrow D \# A \:| \: \epsilon $\\
$B \rightarrow 0 B 0 \: | \: 1 B 1 \: | \: E $\\
$C \rightarrow \#DC \:| \: \epsilon $\\
$D \rightarrow 1D \:| \: 0D \: | \: \epsilon $\\
$E \rightarrow \#DE \:| \: \# $\\
\end{tabular}
\end{table}



\problem{2.7}
Give informal English description of PDAs for the languages in Exercise 2.6 \\ \\
\problem{2.7 b}
The complement of the language $\{a^n b^n | n \geq 0\}$ \\

The PDA would work as follows:\\
\begin{enumerate}[1., leftmargin = 0.8cm]
\itemsep0em
\item Push start symbol on the stack.
\item If the first symbol is a $b$ then move to accept state, since $a^n b^$ cannot start with $b$
    therefore this string is in compliment.
\item If the first symbol is $a$ then push $a$ on the stack, keep pushing a's for all consecutively 
following a's. When see first b after stream of a's, start consuming a's from the stack.
\item If stream is over and there is only start symbol - fail.
\item If start symbol is consumed when b is scanned, then go to accept $b > a$.
\item If followed by a, then go to accept, since string has a form of  $a^i b^j a \cdots$.
\item Last option all bs are consumed, but there is stil a remains on the stack $\rightarrow$ accept state
since $ a > b $
\end{enumerate}


\vspace{0.4cm}

\pagebreak
\problem{2.7 d}
$\{x_1 \# x_2 \# \cdots \# x_k |  k \geq 1, \text{ each }x_i \in \{a,b\}^*,\text{ and for some } i \text{ and } j, x_i 
= {x_j}^R\}$ \\

A PDA that recognizes this language will nondeterministically check all possible combinations of $x_i$ and $x_j$, by pushing
character of $x_i$ onto the stack, and consuming them when checking $x_j$. And skipping all other 
correct string sequences. If a pair $x_i = x^R_j$ is found, and all the rest of the imput is in 
form of $\curl{x_1 \# x_2 \# \cdots \# x_k}$ - Accept, fail otherwise.

\vspace{0.4cm}
\problem{2.9}
Give a context-free grammar that generates the language
\begin{center}
$A = \{a^i b^j c^k | i = j \text{ or } j = k \text{ where } i,j,k \geq 0\}$
\end{center}
Is your grammar ambiguous? Why or why not?

\begin{table}[h!]
\centering
\begin{tabular}{l}
$S \rightarrow A B\: | \: C D $\\
$A \rightarrow aAb \: | \: \epsilon $\\
$B \rightarrow cB \: | \: \epsilon $\\
$C \rightarrow aC \: | \: \epsilon $\\
$D \rightarrow bDc \:| \: \epsilon $\\
\end{tabular}
\end{table}

The language is not ambiguous... \\

\pagebreak

\problem{2.13}
Let $G = (V, \sum, R, S)$ be the following grammar. $V = \{S<T U\}; \sum = \{0,\#\};$ and R is the set of rules:
\begin{table}[h!]
\centering
\begin{tabular}{l}
S $\rightarrow$ $TT$ $|$ $U$ \\
T $\rightarrow$ $0T$ $|$ $T0$ $|$ $\#$   \\
U $\rightarrow$  $0U00$ $|\#$
\end{tabular}
\end{table}

\vspace{0.2cm}

\problem{2.13 a}
Describe $L(G)$ in English. \\

Informally $L(G)$ is either two or more $\#$ separated by arbitrary number of 0's (zero or more)
or zero or more zero followed by $\#$ and by twice as many zeros as in before $\#$. 
More formally it is $\{0^{i_1}_1\#0^{i_2}_2\#0^{i_3}_3\#0^{i_4}_4\#\cdots\#0^{i_n}_k\ |
\text{ where } i_j \geq 0 \text{ and } k \geq 3 \}$ or $\{0^n \# 0^{2n} | n \geq 1\}$ \\ \\

\problem{2.13 b}
Prove that $L(G)$ is not regular. \\

\begin{enumerate}[\underline{Case} 1., leftmargin = 1.5cm]
\itemsep0em
\item Assume that $L(G)$ is regular.
\item Consider the word $0^p\#0^{2p} \in L(G)$. By pumping lemma there eixsts a word $xyz \in L(G)$, and puping
lenght p, such that $|xy| \leq p$ and for all $i \geq 0$, $xy^iz \in L$. In case of word = $0^p \# 0^{2p}$, $xy$
can only be in $0^p$, however for $i \geq 0$ $xy^iz$ is $0^{p+i} \# 0^{2p} \notin L(G)$ is a contradiction. Therefore
$L(G)$ is no regular.
\end{enumerate}

\problem{2.15}
Give a counterexample to show that the following construction fails to prove that the class of context-free languages is closed under star.
Let A be a CFL that is generated by th CFG $G = (V,\sum,R,S)$. Add the new rule $S \rightarrow SS$ and call the
resulting grammar $G'$A. This grammar is supposed to generate $A*$. \\

This rule applied to grammar $G = (\curl{S},\curl{a,b},\curl{S\rightarrow aSb | \epsilon},S)$ + $S\rightarrow SS$ we get grammar $G'$
that can produce a word:
$aababb \notin A^*$ \\ \\

\pagebreak

\problem{2.19}
Let  CFG G be the following grammar.
\begin{table}[h!]
\centering
\begin{tabular}{l}
$S \rightarrow a S b\: | \:b Y \:|\: Y a $\\
$Y \rightarrow b Y \:| \:a Y \:| \:\epsilon$
\end{tabular}
\end{table}

Give a simple description of L(G) in English. Use that description to give a CFG for $\overline{L(G)}$, the compliment of $L(G)$. \\

L(G) is the language that produces all strings not in $a^nb^n$, i.e. compliment of of $a^nb^n$. \\

CFG of $\overline{L(G)}$:

\begin{table}[h!]
\centering
\begin{tabular}{l}
$S \rightarrow a S b\: | \: \epsilon$
\end{tabular}
\end{table}

\problem{2.28}

Give unambiguous CFGs for the following languages.\\ \\
\problem{2.28 a}
$\{w| \text{ in every prefix of } w \text{ the number of a's is at least the number of b's }\}$

\begin{table}[h!]
\centering
\begin{tabular}{l}
$S \rightarrow a S\: | \:B S \:|\: \epsilon $\\
$B \rightarrow a BB b \: | \: \epsilon$\\
\end{tabular}
\end{table}

\problem{2.28 b}
$\{w| \text{ the number of a's and the number of b's in } w \text{ are equal }\}$ \\ \\

\begin{table}[h!]
\centering
\begin{tabular}{l}
$S \rightarrow a A\: | \:b B \:|\: \epsilon $\\
$A \rightarrow b S \:| \:a AA $ \\
$B \rightarrow a S \:| \:b BB $ \\
\end{tabular}
\end{table}

\problem{2.28 c}
$\{w| \text{ the number of a's is at least the number of b's in } w\}$

\begin{table}[h!]
\centering
\begin{tabular}{l}
$S \rightarrow a A\: | \:b B \:|\: a $\\
$A \rightarrow b S \:| \:a AA $ \\
$B \rightarrow a S \:| \:b BB $ \\
\end{tabular}
\end{table}

\pagebreak

\problem{2.30}
Use the pumping lemma to show that the following languages are not context free. \\ \\
\problem{2.30 a}
$L = \{ 0^n 1^n 0^n 1^n | n \geq 0  \}$ \\

Let $p$ be the pumping lentgth, $s = 0^p 1^p 0^p 1^p$. By pumping lemma 
there exists $s = uv^ixy^iz \in L$, where $|vxy| \leq p$ and $|vy| > 1$. There are two 
possible cases for $v$ and $y$.
\begin{enumerate}[\underline{Case} 1., leftmargin = 1.5cm]
\itemsep0em
\item $v$ and $y$ contain at most one type of symbols, then when
we pump $i = p$ we will get string with member of unequal length:
 $s = 0^p 1^{2p} 0^p 1^p \notin L$ or $s = 0^{2p} 1^p 0^p 1^p \notin L$ or $s = 0^{2p} 1^p 0^{2p} 1^p \notin L$ or 
$s = 0^{2p} 1^p 0^{2p} 1^{2p} \notin L$
\item $v$ and $y$ contain different types of symbols, then when $i$ is pumped the resulting 
string will have members out of order, for example $0001110001010111 \notin L$. Therefore $L$ is not Context free.
\end{enumerate}

\vspace{0.2cm}
\problem{2.30 d}
$L = \{ t_1 \# t_2 \# \cdots \# t_k | k \geq 2,\text{ each } t_i \in \{a,b\}^*,
\text{ and }t_i = t_j\text{ for some } i \neq j  \}$  \\

Let $p$ be the pumping lentgth, $s = a^p b ^p \# a^p b^p \in L$. By pumping lemma 
there exists $s = uv^ixy^iz \in L$, where $|vxy| \leq p$ and $|vy| > 1$. There are three
cases
\begin{enumerate}[\underline{Case} 1., leftmargin = 1.5cm]
\itemsep0em
\item $v$ or $y$ contain $\#$. Then for $i = 0$, $s = uxz$ and it doesn't contain $\# \notin L$
\item $v$ and $y$ on the left side of $\#$. Then when we pump $i$ left side becomes longer than the right side $\notin L$
\item $v$ and $y$ on the right side of $\#$. Then when we pump $i$ right side becomes longer than the left side $\notin L$
\end{enumerate}

Therefore $L$ is no Context free.

\vspace{0.4cm}
\problem{2.31}
Let L be the language of all palindromes over $\{0,1\}$ containing equal numbers of 0s and 1s. 
Show that B is not context free. \\

Let $p$ be the pumping lentgth, $s = 0^p 1^2p 0^p \in L$. By pumping lemma 
there exists $s = uv^ixy^iz \in L$, where $|vxy| \leq p$ and $|vy| > 1$. To prove
that $L$ is not context free we need to consider following cases \\

\begin{enumerate}[\underline{Case} 1., leftmargin = 1.5cm]
\itemsep0em
\item $vxy$ consits of only 1's. Then if we pump $i = p$, then $s = 0^p 1^4p 0^p \notin L$, since
number of 1's is greater than number of 0's.
\item $vxy$ consits of only 0's. Then if we pump $i = p$, then $s = 0^2p 1^2p 0^p \notin L$, since
number of 0's is greater than number of 1's and $s$ is no longer a palindrome.
\item $vxy$ consits of 0's and ones. Then if we pump $i = 2$, then $s = u v^2 x y^2 z \notin L$, since
$s$ is no longer a palindrome.
\end{enumerate}

Therefore $L$ is not context free.

\vspace{0.4cm}
\problem{2.33}
Show that $F = \{a^i b^j\: |\: i = kj\text{ for some positive integer } k\}$ is not context free. \\

Let $p$ be the pumping lentgth, $s = a^{q^2} b^q \in F$, where $q$ is a prime, and $q > p$. By pumping lemma 
there exists $s = uv^ixy^iz \in L$, where $|vxy| \leq p$ and $|vy| > 1$. To prove
that $L$ is not context free we need to consider following cases:

\begin{enumerate}[\underline{Case} 1., leftmargin = 1.5cm]
\itemsep0em
\item $vxy$ consits of only a's, then $v = a^k$ and $y = a^l$ in this case it is easy 
    to find such $i$ that $t = \cfrac{q^2 + i\times(k+l)}{q}$ is not an integer
\item $vxy$ consits of only b's, then $v = b^k$ and $y =b^l$ in this case it is easy 
    to find such $i$ that $t = \cfrac{q^2}{q + i\times(k+l)}$ is not an integer
\item $vxy$ consits of a's and b's, then $v = a^k$ and $y =b^l$, $i$ that $t = \cfrac{q^2 +i\times k}{q + i\times l}$,
    there are many possible combinations of $i,k,l$, that make $t$ not intger.
\end{enumerate}

Therefore $F$ is not regular.

\vspace{0.4cm}
\problem{2.35}
Let G be a CFG in Chomsky normal form that contains $b$ variables. Show that if G generates some string with a derivation having 
at least $2^b$ steps, $L(G)$ is infinite. \\

Since Chomsky form can have eiter two variables, or one terminal on the right, therefore it's derivation tree
will be a binary tree. String $w$ that derived with $2^b$ steps will have length $|w| \geq w^b$. Height of such a tree
will be $b + 1$, since there is only $b$ variables, then at least one or more variable is used twice, i.e. language 
contains recursion, hence $L(G)$ is infinite.

\vspace{0.4cm}
\problem{2.46}
Consider the following CFG G:
\begin{table}[h!]
\centering
\begin{tabular}{l}
$S \rightarrow SS \:| \:T$ \\
$T \rightarrow aTb \:| \:ab$
\end{tabular}
\end{table}
Describe $L(G)$ and show that G is ambiguous. Give an unambiguous grammar H where $L(H) = L(G)$ and
sketch a proof that $H$ is unambiguous. \\

$L(G) = \curl{ (a^nb^n)^i | \text{ where } i,n > 0}$. $ababab \in L(G)$ and has two derivation trees

\begin{adjustbox}{valign=t}
\begin{forest}
[S, tier=1
    [S, tier=2
        [S, tier=3
            [T, tier=4
                [ab, tier=5]
            ]
        ]
        [S, tier=3
            [T, tier=4
                [ab, tier=5]
            ]
        ]
    ]
    [S, tier=2
        [T, tier=3
            [ab]
        ]
    ]
]
\end{forest}
\end{adjustbox}\qquad
\begin{adjustbox}{valign=t}
\begin{forest}
[S, tier=1
    [S, tier=2
        [T, tier=3
            [ab]
        ]
    ]
    [S, tier=2
        [S, tier=3
            [T, tier=4
                [ab, tier=5]
            ]
        ]
        [S, tier=3
            [T, tier=4
                [ab, tier=5]
            ]
        ]
    ]
]
\end{forest}
\end{adjustbox}

Therefore $L(G)$ is ambiguous.

Unambiguous grammar for this language is:
\begin{table}[h!]
\centering
\begin{tabular}{l}
$S \rightarrow TS \:| \:\epsilon$ \\
$T \rightarrow aTb \:| \:ab$
\end{tabular}
\end{table}



%\begin{homeworkProblem}
%\end{homeworkProblem}
\end{document}
